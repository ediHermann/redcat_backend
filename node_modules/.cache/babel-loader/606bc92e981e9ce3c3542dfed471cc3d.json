{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _taggedTemplateLiteral2 = _interopRequireDefault(require(\"@babel/runtime/helpers/taggedTemplateLiteral\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _styledComponents = _interopRequireDefault(require(\"styled-components\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _core = require(\"@buffetjs/core\");\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _hooks = require(\"../../../../../../hooks\");\n\nvar _ConditionsModal = _interopRequireDefault(require(\"../../../../ConditionsModal\"));\n\nvar _ConditionsButton = _interopRequireDefault(require(\"../../../../ConditionsButton\"));\n\nvar _CheckboxWrapper = _interopRequireDefault(require(\"../CheckboxWrapper\"));\n\nvar _BaselineAlignment = _interopRequireDefault(require(\"../BaselineAlignment\"));\n\nvar _SubCategoryWrapper = _interopRequireDefault(require(\"./SubCategoryWrapper\"));\n\nvar _ConditionsButtonWrapper = _interopRequireDefault(require(\"./ConditionsButtonWrapper\"));\n\nvar _templateObject;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2[\"default\"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar Border = _styledComponents[\"default\"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2[\"default\"])([\"\\n  flex: 1;\\n  align-self: center;\\n  border-top: 1px solid #f6f6f6;\\n  padding: 0px 10px;\\n\"])));\n\nvar SubCategory = function SubCategory(_ref) {\n  var categoryName = _ref.categoryName,\n      subCategory = _ref.subCategory;\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var _useState = (0, _react.useState)({\n    isOpen: false,\n    isMounted: false\n  }),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      modal = _useState2[0],\n      setModal = _useState2[1];\n\n  var _usePermissionsContex = (0, _hooks.usePermissionsContext)(),\n      pluginsAndSettingsPermissions = _usePermissionsContex.pluginsAndSettingsPermissions,\n      dispatch = _usePermissionsContex.dispatch;\n\n  var checkPermission = (0, _react.useCallback)(function (action) {\n    return pluginsAndSettingsPermissions.findIndex(function (permission) {\n      return permission.action === action;\n    }) !== -1;\n  }, [pluginsAndSettingsPermissions]);\n\n  var handlePermission = function handlePermission(action) {\n    dispatch({\n      type: 'ON_PLUGIN_SETTING_ACTION',\n      action: action\n    });\n  };\n\n  var currentPermissions = (0, _react.useMemo)(function () {\n    return (0, _lodash.intersectionWith)(pluginsAndSettingsPermissions, subCategory.actions, function (x, y) {\n      return x.action === y.action;\n    });\n  }, [pluginsAndSettingsPermissions, subCategory.actions]);\n  var hasAllCategoryActions = (0, _react.useMemo)(function () {\n    return currentPermissions.length === subCategory.actions.length;\n  }, [currentPermissions, subCategory.actions]);\n  var hasSomeCategoryActions = (0, _react.useMemo)(function () {\n    return currentPermissions.length > 0 && currentPermissions.length < subCategory.actions.length;\n  }, [currentPermissions, subCategory.actions]);\n  var categoryConditions = (0, _react.useMemo)(function () {\n    return currentPermissions.reduce(function (acc, current) {\n      return _objectSpread(_objectSpread({}, acc), {}, (0, _defineProperty2[\"default\"])({}, current.action, current.conditions));\n    }, {});\n  }, [currentPermissions]);\n  var hasCategoryConditions = (0, _react.useMemo)(function () {\n    return Object.values(categoryConditions).flat().length > 0;\n  }, [categoryConditions]);\n\n  var handleSubCategoryPermissions = function handleSubCategoryPermissions() {\n    dispatch({\n      type: 'ON_PLUGIN_SETTING_SUB_CATEGORY_ACTIONS',\n      actions: subCategory.actions,\n      shouldEnable: !hasAllCategoryActions\n    });\n  };\n\n  var handleModalOpen = function handleModalOpen() {\n    setModal({\n      isMounted: true,\n      isOpen: true\n    });\n  };\n\n  var handleToggleModal = function handleToggleModal() {\n    setModal(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        isOpen: !prev.isOpen\n      });\n    });\n  };\n\n  var handleClosed = function handleClosed() {\n    setModal(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        isMounted: false\n      });\n    });\n  };\n\n  var actionsForConditions = (0, _react.useMemo)(function () {\n    return currentPermissions.map(function (permission) {\n      return {\n        id: permission.action,\n        displayName: subCategory.actions.find(function (perm) {\n          return perm.action === permission.action;\n        }).displayName\n      };\n    });\n  }, [currentPermissions, subCategory.actions]);\n  var checkCategory = (0, _react.useCallback)(function (action) {\n    return categoryConditions[action] ? categoryConditions[action].length > 0 : false;\n  }, [categoryConditions]);\n\n  var handleConditionsSubmit = function handleConditionsSubmit(conditions) {\n    dispatch({\n      type: 'ON_PLUGIN_SETTING_CONDITIONS_SELECT',\n      conditions: conditions\n    });\n  };\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_SubCategoryWrapper[\"default\"], {\n    disabled: true\n  }, /*#__PURE__*/_react[\"default\"].createElement(_core.Flex, {\n    justifyContent: \"space-between\",\n    alignItems: \"center\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_core.Padded, {\n    right: true,\n    size: \"sm\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_core.Text, {\n    lineHeight: \"18px\",\n    color: \"#919bae\",\n    fontWeight: \"bold\",\n    fontSize: \"xs\",\n    textTransform: \"uppercase\"\n  }, subCategory.subCategory)), /*#__PURE__*/_react[\"default\"].createElement(Border, null), /*#__PURE__*/_react[\"default\"].createElement(_core.Padded, {\n    left: true,\n    size: \"sm\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_BaselineAlignment[\"default\"], null), /*#__PURE__*/_react[\"default\"].createElement(_core.Checkbox, {\n    name: \"select-all-\".concat(subCategory.subCategory),\n    message: formatMessage({\n      id: 'app.utils.select-all'\n    }),\n    disabled: true,\n    onChange: handleSubCategoryPermissions,\n    someChecked: hasSomeCategoryActions,\n    value: hasAllCategoryActions\n  }))), /*#__PURE__*/_react[\"default\"].createElement(_BaselineAlignment[\"default\"], null), /*#__PURE__*/_react[\"default\"].createElement(_core.Padded, {\n    top: true,\n    size: \"xs\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_core.Flex, {\n    flexWrap: \"wrap\"\n  }, subCategory.actions.map(function (sc) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_CheckboxWrapper[\"default\"], {\n      disabled: true,\n      hasConditions: checkCategory(sc.action),\n      key: sc.action\n    }, /*#__PURE__*/_react[\"default\"].createElement(_core.Checkbox, {\n      value: checkPermission(sc.action),\n      name: sc.action,\n      disabled: true,\n      message: sc.displayName,\n      onChange: function onChange() {\n        return handlePermission(sc.action);\n      }\n    }));\n  })), /*#__PURE__*/_react[\"default\"].createElement(_ConditionsButtonWrapper[\"default\"], {\n    disabled: true,\n    hasConditions: hasCategoryConditions\n  }, /*#__PURE__*/_react[\"default\"].createElement(_ConditionsButton[\"default\"], {\n    hasConditions: hasCategoryConditions,\n    onClick: handleModalOpen\n  })))), modal.isMounted && /*#__PURE__*/_react[\"default\"].createElement(_ConditionsModal[\"default\"], {\n    actions: actionsForConditions,\n    initialConditions: categoryConditions,\n    onSubmit: handleConditionsSubmit,\n    onToggle: handleToggleModal,\n    isOpen: modal.isOpen,\n    onClosed: handleClosed,\n    headerBreadCrumbs: [categoryName, subCategory.subCategory]\n  }));\n};\n\nSubCategory.propTypes = {\n  categoryName: _propTypes[\"default\"].string.isRequired,\n  subCategory: _propTypes[\"default\"].object.isRequired\n};\nvar _default = SubCategory;\nexports[\"default\"] = _default;","map":{"version":3,"sources":["D:/webstorm_projects/redcat_backend/.cache/admin/src/components/Roles/Permissions/PluginsAndSettingsPermissions/PermissionRow/SubCategory/index.js"],"names":["Border","styled","div","SubCategory","categoryName","subCategory","formatMessage","isOpen","isMounted","modal","setModal","pluginsAndSettingsPermissions","dispatch","checkPermission","action","findIndex","permission","handlePermission","type","currentPermissions","actions","x","y","hasAllCategoryActions","length","hasSomeCategoryActions","categoryConditions","reduce","acc","current","conditions","hasCategoryConditions","Object","values","flat","handleSubCategoryPermissions","shouldEnable","handleModalOpen","handleToggleModal","prev","handleClosed","actionsForConditions","map","id","displayName","find","perm","checkCategory","handleConditionsSubmit","sc","propTypes","PropTypes","string","isRequired","object"],"mappings":"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","sourcesContent":["import React, { useCallback, useMemo, useState } from 'react';\nimport { intersectionWith } from 'lodash';\nimport styled from 'styled-components';\nimport PropTypes from 'prop-types';\nimport { Flex, Padded, Text, Checkbox } from '@buffetjs/core';\nimport { useIntl } from 'react-intl';\nimport { usePermissionsContext } from '../../../../../../hooks';\nimport ConditionsModal from '../../../../ConditionsModal';\nimport ConditionsButton from '../../../../ConditionsButton';\nimport CheckboxWrapper from '../CheckboxWrapper';\nimport BaselineAlignment from '../BaselineAlignment';\nimport SubCategoryWrapper from './SubCategoryWrapper';\nimport ConditionsButtonWrapper from './ConditionsButtonWrapper';\n\nconst Border = styled.div`\n  flex: 1;\n  align-self: center;\n  border-top: 1px solid #f6f6f6;\n  padding: 0px 10px;\n`;\n\nconst SubCategory = ({ categoryName, subCategory }) => {\n  const { formatMessage } = useIntl();\n  const [modal, setModal] = useState({ isOpen: false, isMounted: false });\n  const { pluginsAndSettingsPermissions, dispatch } = usePermissionsContext();\n\n  const checkPermission = useCallback(\n    action => {\n      return (\n        pluginsAndSettingsPermissions.findIndex(permission => permission.action === action) !== -1\n      );\n    },\n    [pluginsAndSettingsPermissions]\n  );\n\n  const handlePermission = action => {\n    dispatch({\n      type: 'ON_PLUGIN_SETTING_ACTION',\n      action,\n    });\n  };\n\n  const currentPermissions = useMemo(() => {\n    return intersectionWith(\n      pluginsAndSettingsPermissions,\n      subCategory.actions,\n      (x, y) => x.action === y.action\n    );\n  }, [pluginsAndSettingsPermissions, subCategory.actions]);\n\n  const hasAllCategoryActions = useMemo(() => {\n    return currentPermissions.length === subCategory.actions.length;\n  }, [currentPermissions, subCategory.actions]);\n\n  const hasSomeCategoryActions = useMemo(() => {\n    return currentPermissions.length > 0 && currentPermissions.length < subCategory.actions.length;\n  }, [currentPermissions, subCategory.actions]);\n\n  const categoryConditions = useMemo(() => {\n    return currentPermissions.reduce((acc, current) => {\n      return {\n        ...acc,\n        [current.action]: current.conditions,\n      };\n    }, {});\n  }, [currentPermissions]);\n\n  const hasCategoryConditions = useMemo(() => {\n    return Object.values(categoryConditions).flat().length > 0;\n  }, [categoryConditions]);\n\n  const handleSubCategoryPermissions = () => {\n    dispatch({\n      type: 'ON_PLUGIN_SETTING_SUB_CATEGORY_ACTIONS',\n      actions: subCategory.actions,\n      shouldEnable: !hasAllCategoryActions,\n    });\n  };\n\n  const handleModalOpen = () => {\n    setModal({\n      isMounted: true,\n      isOpen: true,\n    });\n  };\n\n  const handleToggleModal = () => {\n    setModal(prev => ({\n      ...prev,\n      isOpen: !prev.isOpen,\n    }));\n  };\n\n  const handleClosed = () => {\n    setModal(prev => ({ ...prev, isMounted: false }));\n  };\n\n  const actionsForConditions = useMemo(() => {\n    return currentPermissions.map(permission => ({\n      id: permission.action,\n      displayName: subCategory.actions.find(perm => perm.action === permission.action).displayName,\n    }));\n  }, [currentPermissions, subCategory.actions]);\n\n  const checkCategory = useCallback(\n    action => {\n      return categoryConditions[action] ? categoryConditions[action].length > 0 : false;\n    },\n    [categoryConditions]\n  );\n\n  const handleConditionsSubmit = conditions => {\n    dispatch({\n      type: 'ON_PLUGIN_SETTING_CONDITIONS_SELECT',\n      conditions,\n    });\n  };\n\n  return (\n    <>\n      <SubCategoryWrapper disabled>\n        <Flex justifyContent=\"space-between\" alignItems=\"center\">\n          <Padded right size=\"sm\">\n            <Text\n              lineHeight=\"18px\"\n              color=\"#919bae\"\n              fontWeight=\"bold\"\n              fontSize=\"xs\"\n              textTransform=\"uppercase\"\n            >\n              {subCategory.subCategory}\n            </Text>\n          </Padded>\n          <Border />\n          <Padded left size=\"sm\">\n            <BaselineAlignment />\n            <Checkbox\n              name={`select-all-${subCategory.subCategory}`}\n              message={formatMessage({ id: 'app.utils.select-all' })}\n              disabled\n              onChange={handleSubCategoryPermissions}\n              someChecked={hasSomeCategoryActions}\n              value={hasAllCategoryActions}\n            />\n          </Padded>\n        </Flex>\n        <BaselineAlignment />\n        <Padded top size=\"xs\">\n          <Flex flexWrap=\"wrap\">\n            {subCategory.actions.map(sc => (\n              <CheckboxWrapper disabled hasConditions={checkCategory(sc.action)} key={sc.action}>\n                <Checkbox\n                  value={checkPermission(sc.action)}\n                  name={sc.action}\n                  disabled\n                  message={sc.displayName}\n                  onChange={() => handlePermission(sc.action)}\n                />\n              </CheckboxWrapper>\n            ))}\n          </Flex>\n          <ConditionsButtonWrapper disabled hasConditions={hasCategoryConditions}>\n            <ConditionsButton hasConditions={hasCategoryConditions} onClick={handleModalOpen} />\n          </ConditionsButtonWrapper>\n        </Padded>\n      </SubCategoryWrapper>\n      {modal.isMounted && (\n        <ConditionsModal\n          actions={actionsForConditions}\n          initialConditions={categoryConditions}\n          onSubmit={handleConditionsSubmit}\n          onToggle={handleToggleModal}\n          isOpen={modal.isOpen}\n          onClosed={handleClosed}\n          headerBreadCrumbs={[categoryName, subCategory.subCategory]}\n        />\n      )}\n    </>\n  );\n};\n\nSubCategory.propTypes = {\n  categoryName: PropTypes.string.isRequired,\n  subCategory: PropTypes.object.isRequired,\n};\n\nexport default SubCategory;\n"]},"metadata":{},"sourceType":"script"}