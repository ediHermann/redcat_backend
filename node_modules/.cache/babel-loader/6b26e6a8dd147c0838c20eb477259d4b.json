{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mapDispatchToProps = mapDispatchToProps;\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactRedux = require(\"react-redux\");\n\nvar _redux = require(\"redux\");\n\nvar _lodash = require(\"lodash\");\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _reactRouterDom = require(\"react-router-dom\");\n\nvar _custom = require(\"@buffetjs/custom\");\n\nvar _reactFastCompare = _interopRequireDefault(require(\"react-fast-compare\"));\n\nvar _qs = require(\"qs\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _pluginId = _interopRequireDefault(require(\"../../pluginId\"));\n\nvar _permissions = _interopRequireDefault(require(\"../../permissions\"));\n\nvar _hooks = require(\"../../hooks\");\n\nvar _utils = require(\"../../utils\");\n\nvar _Container = _interopRequireDefault(require(\"../../components/Container\"));\n\nvar _CustomTable = _interopRequireDefault(require(\"../../components/CustomTable\"));\n\nvar _FilterPicker = _interopRequireDefault(require(\"../../components/FilterPicker\"));\n\nvar _Search = _interopRequireDefault(require(\"../../components/Search\"));\n\nvar _ListViewProvider = _interopRequireDefault(require(\"../ListViewProvider\"));\n\nvar _components = require(\"./components\");\n\nvar _FieldPicker = _interopRequireDefault(require(\"./FieldPicker\"));\n\nvar _Filter = _interopRequireDefault(require(\"./Filter\"));\n\nvar _Footer = _interopRequireDefault(require(\"./Footer\"));\n\nvar _actions = require(\"./actions\");\n\nvar _selectors = _interopRequireDefault(require(\"./selectors\"));\n\nvar _utils2 = require(\"./utils\");\n\n/* eslint-disable react/no-array-index-key */\nfunction ListView(_ref) {\n  var didDeleteData = _ref.didDeleteData,\n      entriesToDelete = _ref.entriesToDelete,\n      onChangeBulk = _ref.onChangeBulk,\n      onChangeBulkSelectall = _ref.onChangeBulkSelectall,\n      onDeleteDataError = _ref.onDeleteDataError,\n      onDeleteDataSucceeded = _ref.onDeleteDataSucceeded,\n      onDeleteSeveralDataSucceeded = _ref.onDeleteSeveralDataSucceeded,\n      setModalLoadingState = _ref.setModalLoadingState,\n      showWarningDelete = _ref.showWarningDelete,\n      showModalConfirmButtonLoading = _ref.showModalConfirmButtonLoading,\n      showWarningDeleteAll = _ref.showWarningDeleteAll,\n      toggleModalDelete = _ref.toggleModalDelete,\n      toggleModalDeleteAll = _ref.toggleModalDeleteAll,\n      data = _ref.data,\n      displayedHeaders = _ref.displayedHeaders,\n      getData = _ref.getData,\n      getDataSucceeded = _ref.getDataSucceeded,\n      isLoading = _ref.isLoading,\n      layout = _ref.layout,\n      onChangeListHeaders = _ref.onChangeListHeaders,\n      onResetListHeaders = _ref.onResetListHeaders,\n      total = _ref.pagination.total,\n      resetProps = _ref.resetProps,\n      setLayout = _ref.setLayout,\n      slug = _ref.slug;\n  var _layout$contentType = layout.contentType,\n      attributes = _layout$contentType.attributes,\n      metadatas = _layout$contentType.metadatas,\n      _layout$contentType$s = _layout$contentType.settings,\n      defaultSortBy = _layout$contentType$s.defaultSortBy,\n      defaultSortOrder = _layout$contentType$s.defaultSortOrder,\n      isBulkable = _layout$contentType$s.bulkable,\n      isFilterable = _layout$contentType$s.filterable,\n      isSearchable = _layout$contentType$s.searchable,\n      defaultPageSize = _layout$contentType$s.pageSize;\n\n  var _useGlobalContext = (0, _strapiHelperPlugin.useGlobalContext)(),\n      emitEvent = _useGlobalContext.emitEvent;\n\n  var emitEventRef = (0, _react.useRef)(emitEvent);\n  var viewPermissions = (0, _react.useMemo)(function () {\n    return (0, _utils.generatePermissionsObject)(slug);\n  }, [slug]);\n\n  var _useUserPermissions = (0, _strapiHelperPlugin.useUserPermissions)(viewPermissions),\n      isLoadingForPermissions = _useUserPermissions.isLoading,\n      _useUserPermissions$a = _useUserPermissions.allowedActions,\n      canCreate = _useUserPermissions$a.canCreate,\n      canRead = _useUserPermissions$a.canRead,\n      canUpdate = _useUserPermissions$a.canUpdate,\n      canDelete = _useUserPermissions$a.canDelete;\n\n  var defaultSort = \"\".concat(defaultSortBy, \":\").concat(defaultSortOrder);\n  var initParams = (0, _react.useMemo)(function () {\n    return {\n      page: 1,\n      pageSize: defaultPageSize,\n      _sort: defaultSort\n    };\n  }, [defaultPageSize, defaultSort]);\n\n  var _useQueryParams = (0, _hooks.useQueryParams)(initParams),\n      _useQueryParams2 = (0, _slicedToArray2[\"default\"])(_useQueryParams, 2),\n      _useQueryParams2$ = _useQueryParams2[0],\n      query = _useQueryParams2$.query,\n      rawQuery = _useQueryParams2$.rawQuery,\n      setQuery = _useQueryParams2[1];\n\n  var _useLocation = (0, _reactRouterDom.useLocation)(),\n      pathname = _useLocation.pathname;\n\n  var _useHistory = (0, _reactRouterDom.useHistory)(),\n      push = _useHistory.push;\n\n  var _useIntl = (0, _reactIntl.useIntl)(),\n      formatMessage = _useIntl.formatMessage;\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      isFilterPickerOpen = _useState2[0],\n      setFilterPickerState = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(null),\n      _useState4 = (0, _slicedToArray2[\"default\"])(_useState3, 2),\n      idToDelete = _useState4[0],\n      setIdToDelete = _useState4[1];\n\n  var contentType = layout.contentType;\n  var hasDraftAndPublish = (0, _lodash.get)(contentType, 'options.draftAndPublish', false);\n  var allAllowedHeaders = (0, _react.useMemo)(function () {\n    return (0, _utils2.getAllAllowedHeaders)(attributes);\n  }, [attributes]);\n  var filters = (0, _react.useMemo)(function () {\n    return (0, _utils.formatFiltersFromQuery)(query);\n  }, [query]);\n  var _sort = query._sort;\n\n  var _q = query._q || '';\n\n  var label = contentType.info.label;\n  var params = (0, _react.useMemo)(function () {\n    return rawQuery || \"?\".concat((0, _qs.stringify)(initParams, {\n      encode: false\n    }));\n  }, [initParams, rawQuery]);\n  var firstSortableHeader = (0, _react.useMemo)(function () {\n    return (0, _utils2.getFirstSortableHeader)(displayedHeaders);\n  }, [displayedHeaders]);\n  (0, _react.useEffect)(function () {\n    setLayout(layout);\n    setFilterPickerState(false);\n    return function () {\n      resetProps();\n    };\n  }, [layout, setLayout, resetProps]); // Using a ref to avoid requests being fired multiple times on slug on change\n  // We need it because the hook as mulitple dependencies so it may run before the permissions have checked\n\n  var requestUrlRef = (0, _react.useRef)('');\n  var fetchData = (0, _react.useCallback)( /*#__PURE__*/function () {\n    var _ref2 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(endPoint) {\n      var abortSignal,\n          signal,\n          _yield$request,\n          results,\n          pagination,\n          _args = arguments;\n\n      return _regenerator[\"default\"].wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              abortSignal = _args.length > 1 && _args[1] !== undefined ? _args[1] : false;\n              getData();\n              signal = abortSignal || new AbortController().signal;\n              _context.prev = 3;\n              _context.next = 6;\n              return (0, _strapiHelperPlugin.request)(endPoint, {\n                method: 'GET',\n                signal: signal\n              });\n\n            case 6:\n              _yield$request = _context.sent;\n              results = _yield$request.results;\n              pagination = _yield$request.pagination;\n              getDataSucceeded(pagination, results);\n              _context.next = 15;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](3);\n\n              if (_context.t0.name !== 'AbortError') {\n                console.error(_context.t0);\n                strapi.notification.error((0, _utils.getTrad)('error.model.fetch'));\n              }\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 12]]);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), [getData, getDataSucceeded]);\n  var handleChangeListLabels = (0, _react.useCallback)(function (_ref3) {\n    var name = _ref3.name,\n        value = _ref3.value;\n\n    // Display a notification if trying to remove the last displayed field\n    if (value && displayedHeaders.length === 1) {\n      strapi.notification.toggle({\n        type: 'warning',\n        message: {\n          id: 'content-manager.notification.error.displayedFields'\n        }\n      });\n    } else {\n      emitEventRef.current('didChangeDisplayedFields');\n      onChangeListHeaders({\n        name: name,\n        value: value\n      });\n    }\n  }, [displayedHeaders, onChangeListHeaders]);\n  var handleConfirmDeleteAllData = (0, _react.useCallback)( /*#__PURE__*/(0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee2() {\n    return _regenerator[\"default\"].wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            setModalLoadingState();\n            _context2.next = 4;\n            return (0, _strapiHelperPlugin.request)((0, _utils.getRequestUrl)(\"collection-types/\".concat(slug, \"/actions/bulkDelete\")), {\n              method: 'POST',\n              body: {\n                ids: entriesToDelete\n              }\n            });\n\n          case 4:\n            onDeleteSeveralDataSucceeded();\n            emitEventRef.current('didBulkDeleteEntries');\n            _context2.next = 11;\n            break;\n\n          case 8:\n            _context2.prev = 8;\n            _context2.t0 = _context2[\"catch\"](0);\n            strapi.notification.error(\"\".concat(_pluginId[\"default\"], \".error.record.delete\"));\n\n          case 11:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[0, 8]]);\n  })), [entriesToDelete, onDeleteSeveralDataSucceeded, slug, setModalLoadingState]);\n  var handleConfirmDeleteData = (0, _react.useCallback)( /*#__PURE__*/(0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee3() {\n    var trackerProperty, dataToDelete, isDraftEntry, status, errorMessage;\n    return _regenerator[\"default\"].wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.prev = 0;\n            trackerProperty = {};\n\n            if (hasDraftAndPublish) {\n              dataToDelete = data.find(function (obj) {\n                return obj.id.toString() === idToDelete.toString();\n              });\n              isDraftEntry = (0, _lodash.isEmpty)(dataToDelete.published_at);\n              status = isDraftEntry ? 'draft' : 'published';\n              trackerProperty = {\n                status: status\n              };\n            }\n\n            emitEventRef.current('willDeleteEntry', trackerProperty);\n            setModalLoadingState();\n            _context3.next = 7;\n            return (0, _strapiHelperPlugin.request)((0, _utils.getRequestUrl)(\"collection-types/\".concat(slug, \"/\").concat(idToDelete)), {\n              method: 'DELETE'\n            });\n\n          case 7:\n            strapi.notification.toggle({\n              type: 'success',\n              message: {\n                id: \"\".concat(_pluginId[\"default\"], \".success.record.delete\")\n              }\n            }); // Close the modal and refetch data\n\n            onDeleteDataSucceeded();\n            emitEventRef.current('didDeleteEntry', trackerProperty);\n            _context3.next = 17;\n            break;\n\n          case 12:\n            _context3.prev = 12;\n            _context3.t0 = _context3[\"catch\"](0);\n            errorMessage = (0, _lodash.get)(_context3.t0, 'response.payload.message', formatMessage({\n              id: \"\".concat(_pluginId[\"default\"], \".error.record.delete\")\n            }));\n            strapi.notification.toggle({\n              type: 'warning',\n              message: errorMessage\n            }); // Close the modal\n\n            onDeleteDataError();\n\n          case 17:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[0, 12]]);\n  })), [hasDraftAndPublish, setModalLoadingState, slug, idToDelete, onDeleteDataSucceeded, data, formatMessage, onDeleteDataError]);\n  (0, _react.useEffect)(function () {\n    var abortController = new AbortController();\n    var signal = abortController.signal;\n    var shouldSendRequest = !isLoadingForPermissions && canRead;\n    var requestUrl = \"/\".concat(_pluginId[\"default\"], \"/collection-types/\").concat(slug).concat(params);\n\n    if (shouldSendRequest && requestUrl.includes(requestUrlRef.current)) {\n      fetchData(requestUrl, signal);\n    }\n\n    return function () {\n      requestUrlRef.current = slug;\n      abortController.abort();\n    };\n  }, [isLoadingForPermissions, canRead, getData, slug, params, getDataSucceeded, fetchData]);\n\n  var handleClickDelete = function handleClickDelete(id) {\n    setIdToDelete(id);\n    toggleModalDelete();\n  };\n\n  var handleModalClose = (0, _react.useCallback)(function () {\n    if (didDeleteData) {\n      var requestUrl = \"/\".concat(_pluginId[\"default\"], \"/collection-types/\").concat(slug).concat(params);\n      fetchData(requestUrl);\n    }\n  }, [fetchData, didDeleteData, slug, params]);\n  var toggleFilterPickerState = (0, _react.useCallback)(function () {\n    setFilterPickerState(function (prevState) {\n      if (!prevState) {\n        emitEventRef.current('willFilterEntries');\n      }\n\n      return !prevState;\n    });\n  }, []);\n  var headerAction = (0, _react.useMemo)(function () {\n    if (!canCreate) {\n      return [];\n    }\n\n    return [{\n      label: formatMessage({\n        id: 'content-manager.containers.List.addAnEntry'\n      }, {\n        entity: label || 'Content Manager'\n      }),\n      onClick: function onClick() {\n        var trackerProperty = hasDraftAndPublish ? {\n          status: 'draft'\n        } : {};\n        emitEventRef.current('willCreateEntry', trackerProperty);\n        push({\n          pathname: \"\".concat(pathname, \"/create\")\n        });\n      },\n      color: 'primary',\n      type: 'button',\n      icon: true,\n      style: {\n        paddingLeft: 15,\n        paddingRight: 15,\n        fontWeight: 600\n      }\n    }];\n  }, [label, pathname, canCreate, formatMessage, hasDraftAndPublish, push]);\n  var headerProps = (0, _react.useMemo)(function () {\n    /* eslint-disable indent */\n    return {\n      title: {\n        label: label || 'Content Manager'\n      },\n      content: canRead ? formatMessage({\n        id: total > 1 ? \"\".concat(_pluginId[\"default\"], \".containers.List.pluginHeaderDescription\") : \"\".concat(_pluginId[\"default\"], \".containers.List.pluginHeaderDescription.singular\")\n      }, {\n        label: total\n      }) : null,\n      actions: headerAction\n    };\n  }, [total, headerAction, label, canRead, formatMessage]);\n\n  var handleToggleModalDeleteAll = function handleToggleModalDeleteAll(e) {\n    emitEventRef.current('willBulkDeleteEntries');\n    toggleModalDeleteAll(e);\n  };\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_ListViewProvider[\"default\"], {\n    _q: _q,\n    _sort: _sort,\n    data: data,\n    entriesToDelete: entriesToDelete,\n    filters: filters,\n    firstSortableHeader: firstSortableHeader,\n    label: label,\n    onChangeBulk: onChangeBulk,\n    onChangeBulkSelectall: onChangeBulkSelectall,\n    onClickDelete: handleClickDelete,\n    slug: slug,\n    toggleModalDeleteAll: handleToggleModalDeleteAll,\n    setQuery: setQuery\n  }, /*#__PURE__*/_react[\"default\"].createElement(_FilterPicker[\"default\"], {\n    contentType: contentType,\n    filters: filters,\n    isOpen: isFilterPickerOpen,\n    metadatas: metadatas,\n    name: label,\n    toggleFilterPickerState: toggleFilterPickerState,\n    setQuery: setQuery,\n    slug: slug\n  }), /*#__PURE__*/_react[\"default\"].createElement(_Container[\"default\"], {\n    className: \"container-fluid\"\n  }, !isFilterPickerOpen && /*#__PURE__*/_react[\"default\"].createElement(_custom.Header, (0, _extends2[\"default\"])({}, headerProps, {\n    isLoading: isLoading && canRead\n  })), isSearchable && canRead && /*#__PURE__*/_react[\"default\"].createElement(_Search[\"default\"], {\n    changeParams: setQuery,\n    initValue: _q,\n    model: label,\n    value: _q\n  }), canRead && /*#__PURE__*/_react[\"default\"].createElement(_components.Wrapper, null, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"row\",\n    style: {\n      marginBottom: '5px'\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"col-10\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"row\",\n    style: {\n      marginLeft: 0,\n      marginRight: 0\n    }\n  }, isFilterable && /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_components.AddFilterCta, {\n    type: \"button\",\n    onClick: toggleFilterPickerState\n  }, /*#__PURE__*/_react[\"default\"].createElement(_components.FilterIcon, null), /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"app.utils.filters\"\n  })), filters.map(function (_ref6, key) {\n    var filterName = _ref6.filter,\n        name = _ref6.name,\n        value = _ref6.value;\n    return /*#__PURE__*/_react[\"default\"].createElement(_Filter[\"default\"], {\n      contentType: contentType,\n      filterName: filterName,\n      filters: filters,\n      index: key,\n      key: key,\n      metadatas: metadatas,\n      name: name,\n      toggleFilterPickerState: toggleFilterPickerState,\n      isFilterPickerOpen: isFilterPickerOpen,\n      setQuery: setQuery,\n      value: value\n    });\n  })))), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"col-2\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.CheckPermissions, {\n    permissions: _permissions[\"default\"].collectionTypesConfigurations\n  }, /*#__PURE__*/_react[\"default\"].createElement(_FieldPicker[\"default\"], {\n    displayedHeaders: displayedHeaders,\n    items: allAllowedHeaders,\n    onChange: handleChangeListLabels,\n    onClickReset: onResetListHeaders,\n    slug: slug\n  })))), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"row\",\n    style: {\n      paddingTop: '12px'\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"col-12\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_CustomTable[\"default\"], {\n    data: data,\n    canCreate: canCreate,\n    canDelete: canDelete,\n    canUpdate: canUpdate,\n    displayedHeaders: displayedHeaders,\n    hasDraftAndPublish: hasDraftAndPublish,\n    isBulkable: isBulkable,\n    setQuery: setQuery,\n    showLoader: isLoading\n  }), /*#__PURE__*/_react[\"default\"].createElement(_Footer[\"default\"], {\n    count: total,\n    params: query,\n    onChange: setQuery\n  }))))), /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.PopUpWarning, {\n    isOpen: showWarningDelete,\n    toggleModal: toggleModalDelete,\n    content: {\n      message: (0, _utils.getTrad)('popUpWarning.bodyMessage.contentType.delete')\n    },\n    onConfirm: handleConfirmDeleteData,\n    popUpWarningType: \"danger\",\n    onClosed: handleModalClose,\n    isConfirmButtonLoading: showModalConfirmButtonLoading\n  }), /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.PopUpWarning, {\n    isOpen: showWarningDeleteAll,\n    toggleModal: toggleModalDeleteAll,\n    content: {\n      message: (0, _utils.getTrad)(\"popUpWarning.bodyMessage.contentType.delete\".concat(entriesToDelete.length > 1 ? '.all' : ''))\n    },\n    popUpWarningType: \"danger\",\n    onConfirm: handleConfirmDeleteAllData,\n    onClosed: handleModalClose,\n    isConfirmButtonLoading: showModalConfirmButtonLoading\n  })));\n}\n\nListView.propTypes = {\n  displayedHeaders: _propTypes[\"default\"].array.isRequired,\n  data: _propTypes[\"default\"].array.isRequired,\n  didDeleteData: _propTypes[\"default\"].bool.isRequired,\n  entriesToDelete: _propTypes[\"default\"].array.isRequired,\n  layout: _propTypes[\"default\"].exact({\n    components: _propTypes[\"default\"].object.isRequired,\n    contentType: _propTypes[\"default\"].shape({\n      attributes: _propTypes[\"default\"].object.isRequired,\n      metadatas: _propTypes[\"default\"].object.isRequired,\n      info: _propTypes[\"default\"].shape({\n        label: _propTypes[\"default\"].string.isRequired\n      }).isRequired,\n      layouts: _propTypes[\"default\"].shape({\n        list: _propTypes[\"default\"].array.isRequired,\n        editRelations: _propTypes[\"default\"].array\n      }).isRequired,\n      options: _propTypes[\"default\"].object.isRequired,\n      settings: _propTypes[\"default\"].object.isRequired\n    }).isRequired\n  }).isRequired,\n  isLoading: _propTypes[\"default\"].bool.isRequired,\n  getData: _propTypes[\"default\"].func.isRequired,\n  getDataSucceeded: _propTypes[\"default\"].func.isRequired,\n  onChangeBulk: _propTypes[\"default\"].func.isRequired,\n  onChangeBulkSelectall: _propTypes[\"default\"].func.isRequired,\n  onChangeListHeaders: _propTypes[\"default\"].func.isRequired,\n  onDeleteDataError: _propTypes[\"default\"].func.isRequired,\n  onDeleteDataSucceeded: _propTypes[\"default\"].func.isRequired,\n  onDeleteSeveralDataSucceeded: _propTypes[\"default\"].func.isRequired,\n  onResetListHeaders: _propTypes[\"default\"].func.isRequired,\n  pagination: _propTypes[\"default\"].shape({\n    total: _propTypes[\"default\"].number.isRequired\n  }).isRequired,\n  resetProps: _propTypes[\"default\"].func.isRequired,\n  setModalLoadingState: _propTypes[\"default\"].func.isRequired,\n  showModalConfirmButtonLoading: _propTypes[\"default\"].bool.isRequired,\n  showWarningDelete: _propTypes[\"default\"].bool.isRequired,\n  showWarningDeleteAll: _propTypes[\"default\"].bool.isRequired,\n  slug: _propTypes[\"default\"].string.isRequired,\n  toggleModalDelete: _propTypes[\"default\"].func.isRequired,\n  toggleModalDeleteAll: _propTypes[\"default\"].func.isRequired,\n  setLayout: _propTypes[\"default\"].func.isRequired\n};\nvar mapStateToProps = (0, _selectors[\"default\"])();\n\nfunction mapDispatchToProps(dispatch) {\n  return (0, _redux.bindActionCreators)({\n    getData: _actions.getData,\n    getDataSucceeded: _actions.getDataSucceeded,\n    onChangeBulk: _actions.onChangeBulk,\n    onChangeBulkSelectall: _actions.onChangeBulkSelectall,\n    onChangeListHeaders: _actions.onChangeListHeaders,\n    onDeleteDataError: _actions.onDeleteDataError,\n    onDeleteDataSucceeded: _actions.onDeleteDataSucceeded,\n    onDeleteSeveralDataSucceeded: _actions.onDeleteSeveralDataSucceeded,\n    onResetListHeaders: _actions.onResetListHeaders,\n    resetProps: _actions.resetProps,\n    setModalLoadingState: _actions.setModalLoadingState,\n    toggleModalDelete: _actions.toggleModalDelete,\n    toggleModalDeleteAll: _actions.toggleModalDeleteAll,\n    setLayout: _actions.setLayout\n  }, dispatch);\n}\n\nvar withConnect = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps);\n\nvar _default = (0, _redux.compose)(withConnect)( /*#__PURE__*/(0, _react.memo)(ListView, _reactFastCompare[\"default\"]));\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["D:/webstorm_projects/redcat_backend/.cache/plugins/strapi-plugin-content-manager/admin/src/containers/ListView/index.js"],"names":["ListView","didDeleteData","entriesToDelete","onChangeBulk","onChangeBulkSelectall","onDeleteDataError","onDeleteDataSucceeded","onDeleteSeveralDataSucceeded","setModalLoadingState","showWarningDelete","showModalConfirmButtonLoading","showWarningDeleteAll","toggleModalDelete","toggleModalDeleteAll","data","displayedHeaders","getData","getDataSucceeded","isLoading","layout","onChangeListHeaders","onResetListHeaders","total","pagination","resetProps","setLayout","slug","contentType","attributes","metadatas","settings","defaultSortBy","defaultSortOrder","isBulkable","bulkable","isFilterable","filterable","isSearchable","searchable","defaultPageSize","pageSize","emitEvent","emitEventRef","viewPermissions","isLoadingForPermissions","allowedActions","canCreate","canRead","canUpdate","canDelete","defaultSort","initParams","page","_sort","query","rawQuery","setQuery","pathname","push","formatMessage","isFilterPickerOpen","setFilterPickerState","idToDelete","setIdToDelete","hasDraftAndPublish","allAllowedHeaders","filters","_q","label","info","params","encode","firstSortableHeader","requestUrlRef","fetchData","endPoint","abortSignal","signal","AbortController","method","results","name","console","error","strapi","notification","handleChangeListLabels","value","length","toggle","type","message","id","current","handleConfirmDeleteAllData","body","ids","pluginId","handleConfirmDeleteData","trackerProperty","dataToDelete","find","obj","toString","isDraftEntry","published_at","status","errorMessage","abortController","shouldSendRequest","requestUrl","includes","abort","handleClickDelete","handleModalClose","toggleFilterPickerState","prevState","headerAction","entity","onClick","color","icon","style","paddingLeft","paddingRight","fontWeight","headerProps","title","content","actions","handleToggleModalDeleteAll","e","marginBottom","marginLeft","marginRight","map","key","filterName","filter","pluginPermissions","collectionTypesConfigurations","paddingTop","propTypes","PropTypes","array","isRequired","bool","exact","components","object","shape","string","layouts","list","editRelations","options","func","number","mapStateToProps","mapDispatchToProps","dispatch","withConnect","isEqual"],"mappings":"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","sourcesContent":["import React, { memo, useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { bindActionCreators, compose } from 'redux';\nimport { get, isEmpty } from 'lodash';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport { Header } from '@buffetjs/custom';\nimport isEqual from 'react-fast-compare';\nimport { stringify } from 'qs';\nimport {\n  PopUpWarning,\n  request,\n  CheckPermissions,\n  useGlobalContext,\n  useUserPermissions,\n} from 'strapi-helper-plugin';\nimport pluginId from '../../pluginId';\nimport pluginPermissions from '../../permissions';\nimport { useQueryParams } from '../../hooks';\nimport {\n  formatFiltersFromQuery,\n  generatePermissionsObject,\n  getRequestUrl,\n  getTrad,\n} from '../../utils';\nimport Container from '../../components/Container';\nimport CustomTable from '../../components/CustomTable';\nimport FilterPicker from '../../components/FilterPicker';\nimport Search from '../../components/Search';\nimport ListViewProvider from '../ListViewProvider';\nimport { AddFilterCta, FilterIcon, Wrapper } from './components';\nimport FieldPicker from './FieldPicker';\nimport Filter from './Filter';\nimport Footer from './Footer';\nimport {\n  getData,\n  getDataSucceeded,\n  onChangeBulk,\n  onChangeBulkSelectall,\n  onDeleteDataError,\n  onDeleteDataSucceeded,\n  onDeleteSeveralDataSucceeded,\n  resetProps,\n  setModalLoadingState,\n  toggleModalDelete,\n  toggleModalDeleteAll,\n  setLayout,\n  onChangeListHeaders,\n  onResetListHeaders,\n} from './actions';\nimport makeSelectListView from './selectors';\n\nimport { getAllAllowedHeaders, getFirstSortableHeader } from './utils';\n\n/* eslint-disable react/no-array-index-key */\n\nfunction ListView({\n  didDeleteData,\n  entriesToDelete,\n  onChangeBulk,\n  onChangeBulkSelectall,\n  onDeleteDataError,\n  onDeleteDataSucceeded,\n  onDeleteSeveralDataSucceeded,\n  setModalLoadingState,\n  showWarningDelete,\n  showModalConfirmButtonLoading,\n  showWarningDeleteAll,\n  toggleModalDelete,\n  toggleModalDeleteAll,\n  data,\n  displayedHeaders,\n  getData,\n  getDataSucceeded,\n  isLoading,\n  layout,\n  onChangeListHeaders,\n  onResetListHeaders,\n  pagination: { total },\n  resetProps,\n  setLayout,\n  slug,\n}) {\n  const {\n    contentType: {\n      attributes,\n      metadatas,\n      settings: {\n        defaultSortBy,\n        defaultSortOrder,\n        bulkable: isBulkable,\n        filterable: isFilterable,\n        searchable: isSearchable,\n        pageSize: defaultPageSize,\n      },\n    },\n  } = layout;\n\n  const { emitEvent } = useGlobalContext();\n  const emitEventRef = useRef(emitEvent);\n  const viewPermissions = useMemo(() => generatePermissionsObject(slug), [slug]);\n  const {\n    isLoading: isLoadingForPermissions,\n    allowedActions: { canCreate, canRead, canUpdate, canDelete },\n  } = useUserPermissions(viewPermissions);\n  const defaultSort = `${defaultSortBy}:${defaultSortOrder}`;\n  const initParams = useMemo(() => ({ page: 1, pageSize: defaultPageSize, _sort: defaultSort }), [\n    defaultPageSize,\n    defaultSort,\n  ]);\n  const [{ query, rawQuery }, setQuery] = useQueryParams(initParams);\n\n  const { pathname } = useLocation();\n  const { push } = useHistory();\n  const { formatMessage } = useIntl();\n\n  const [isFilterPickerOpen, setFilterPickerState] = useState(false);\n  const [idToDelete, setIdToDelete] = useState(null);\n  const contentType = layout.contentType;\n  const hasDraftAndPublish = get(contentType, 'options.draftAndPublish', false);\n  const allAllowedHeaders = useMemo(() => getAllAllowedHeaders(attributes), [attributes]);\n\n  const filters = useMemo(() => {\n    return formatFiltersFromQuery(query);\n  }, [query]);\n\n  const _sort = query._sort;\n  const _q = query._q || '';\n\n  const label = contentType.info.label;\n\n  const params = useMemo(() => {\n    return rawQuery || `?${stringify(initParams, { encode: false })}`;\n  }, [initParams, rawQuery]);\n\n  const firstSortableHeader = useMemo(() => getFirstSortableHeader(displayedHeaders), [\n    displayedHeaders,\n  ]);\n\n  useEffect(() => {\n    setLayout(layout);\n    setFilterPickerState(false);\n\n    return () => {\n      resetProps();\n    };\n  }, [layout, setLayout, resetProps]);\n\n  // Using a ref to avoid requests being fired multiple times on slug on change\n  // We need it because the hook as mulitple dependencies so it may run before the permissions have checked\n  const requestUrlRef = useRef('');\n\n  const fetchData = useCallback(\n    async (endPoint, abortSignal = false) => {\n      getData();\n      const signal = abortSignal || new AbortController().signal;\n\n      try {\n        const { results, pagination } = await request(endPoint, { method: 'GET', signal });\n\n        getDataSucceeded(pagination, results);\n      } catch (err) {\n        if (err.name !== 'AbortError') {\n          console.error(err);\n          strapi.notification.error(getTrad('error.model.fetch'));\n        }\n      }\n    },\n    [getData, getDataSucceeded]\n  );\n\n  const handleChangeListLabels = useCallback(\n    ({ name, value }) => {\n      // Display a notification if trying to remove the last displayed field\n\n      if (value && displayedHeaders.length === 1) {\n        strapi.notification.toggle({\n          type: 'warning',\n          message: { id: 'content-manager.notification.error.displayedFields' },\n        });\n      } else {\n        emitEventRef.current('didChangeDisplayedFields');\n\n        onChangeListHeaders({ name, value });\n      }\n    },\n    [displayedHeaders, onChangeListHeaders]\n  );\n\n  const handleConfirmDeleteAllData = useCallback(async () => {\n    try {\n      setModalLoadingState();\n\n      await request(getRequestUrl(`collection-types/${slug}/actions/bulkDelete`), {\n        method: 'POST',\n        body: { ids: entriesToDelete },\n      });\n\n      onDeleteSeveralDataSucceeded();\n      emitEventRef.current('didBulkDeleteEntries');\n    } catch (err) {\n      strapi.notification.error(`${pluginId}.error.record.delete`);\n    }\n  }, [entriesToDelete, onDeleteSeveralDataSucceeded, slug, setModalLoadingState]);\n\n  const handleConfirmDeleteData = useCallback(async () => {\n    try {\n      let trackerProperty = {};\n\n      if (hasDraftAndPublish) {\n        const dataToDelete = data.find(obj => obj.id.toString() === idToDelete.toString());\n        const isDraftEntry = isEmpty(dataToDelete.published_at);\n        const status = isDraftEntry ? 'draft' : 'published';\n\n        trackerProperty = { status };\n      }\n\n      emitEventRef.current('willDeleteEntry', trackerProperty);\n      setModalLoadingState();\n\n      await request(getRequestUrl(`collection-types/${slug}/${idToDelete}`), {\n        method: 'DELETE',\n      });\n\n      strapi.notification.toggle({\n        type: 'success',\n        message: { id: `${pluginId}.success.record.delete` },\n      });\n\n      // Close the modal and refetch data\n      onDeleteDataSucceeded();\n      emitEventRef.current('didDeleteEntry', trackerProperty);\n    } catch (err) {\n      const errorMessage = get(\n        err,\n        'response.payload.message',\n        formatMessage({ id: `${pluginId}.error.record.delete` })\n      );\n\n      strapi.notification.toggle({\n        type: 'warning',\n        message: errorMessage,\n      });\n      // Close the modal\n      onDeleteDataError();\n    }\n  }, [\n    hasDraftAndPublish,\n    setModalLoadingState,\n    slug,\n    idToDelete,\n    onDeleteDataSucceeded,\n    data,\n    formatMessage,\n    onDeleteDataError,\n  ]);\n\n  useEffect(() => {\n    const abortController = new AbortController();\n    const { signal } = abortController;\n\n    const shouldSendRequest = !isLoadingForPermissions && canRead;\n    const requestUrl = `/${pluginId}/collection-types/${slug}${params}`;\n\n    if (shouldSendRequest && requestUrl.includes(requestUrlRef.current)) {\n      fetchData(requestUrl, signal);\n    }\n\n    return () => {\n      requestUrlRef.current = slug;\n      abortController.abort();\n    };\n  }, [isLoadingForPermissions, canRead, getData, slug, params, getDataSucceeded, fetchData]);\n\n  const handleClickDelete = id => {\n    setIdToDelete(id);\n    toggleModalDelete();\n  };\n\n  const handleModalClose = useCallback(() => {\n    if (didDeleteData) {\n      const requestUrl = `/${pluginId}/collection-types/${slug}${params}`;\n\n      fetchData(requestUrl);\n    }\n  }, [fetchData, didDeleteData, slug, params]);\n\n  const toggleFilterPickerState = useCallback(() => {\n    setFilterPickerState(prevState => {\n      if (!prevState) {\n        emitEventRef.current('willFilterEntries');\n      }\n\n      return !prevState;\n    });\n  }, []);\n\n  const headerAction = useMemo(() => {\n    if (!canCreate) {\n      return [];\n    }\n\n    return [\n      {\n        label: formatMessage(\n          {\n            id: 'content-manager.containers.List.addAnEntry',\n          },\n          {\n            entity: label || 'Content Manager',\n          }\n        ),\n        onClick: () => {\n          const trackerProperty = hasDraftAndPublish ? { status: 'draft' } : {};\n\n          emitEventRef.current('willCreateEntry', trackerProperty);\n          push({\n            pathname: `${pathname}/create`,\n          });\n        },\n        color: 'primary',\n        type: 'button',\n        icon: true,\n        style: {\n          paddingLeft: 15,\n          paddingRight: 15,\n          fontWeight: 600,\n        },\n      },\n    ];\n  }, [label, pathname, canCreate, formatMessage, hasDraftAndPublish, push]);\n\n  const headerProps = useMemo(() => {\n    /* eslint-disable indent */\n    return {\n      title: {\n        label: label || 'Content Manager',\n      },\n      content: canRead\n        ? formatMessage(\n            {\n              id:\n                total > 1\n                  ? `${pluginId}.containers.List.pluginHeaderDescription`\n                  : `${pluginId}.containers.List.pluginHeaderDescription.singular`,\n            },\n            { label: total }\n          )\n        : null,\n      actions: headerAction,\n    };\n  }, [total, headerAction, label, canRead, formatMessage]);\n\n  const handleToggleModalDeleteAll = e => {\n    emitEventRef.current('willBulkDeleteEntries');\n    toggleModalDeleteAll(e);\n  };\n\n  return (\n    <>\n      <ListViewProvider\n        _q={_q}\n        _sort={_sort}\n        data={data}\n        entriesToDelete={entriesToDelete}\n        filters={filters}\n        firstSortableHeader={firstSortableHeader}\n        label={label}\n        onChangeBulk={onChangeBulk}\n        onChangeBulkSelectall={onChangeBulkSelectall}\n        onClickDelete={handleClickDelete}\n        slug={slug}\n        toggleModalDeleteAll={handleToggleModalDeleteAll}\n        setQuery={setQuery}\n      >\n        <FilterPicker\n          contentType={contentType}\n          filters={filters}\n          isOpen={isFilterPickerOpen}\n          metadatas={metadatas}\n          name={label}\n          toggleFilterPickerState={toggleFilterPickerState}\n          setQuery={setQuery}\n          slug={slug}\n        />\n        <Container className=\"container-fluid\">\n          {!isFilterPickerOpen && <Header {...headerProps} isLoading={isLoading && canRead} />}\n          {isSearchable && canRead && (\n            <Search changeParams={setQuery} initValue={_q} model={label} value={_q} />\n          )}\n          {canRead && (\n            <Wrapper>\n              <div className=\"row\" style={{ marginBottom: '5px' }}>\n                <div className=\"col-10\">\n                  <div className=\"row\" style={{ marginLeft: 0, marginRight: 0 }}>\n                    {isFilterable && (\n                      <>\n                        <AddFilterCta type=\"button\" onClick={toggleFilterPickerState}>\n                          <FilterIcon />\n                          <FormattedMessage id=\"app.utils.filters\" />\n                        </AddFilterCta>\n                        {filters.map(({ filter: filterName, name, value }, key) => (\n                          <Filter\n                            contentType={contentType}\n                            filterName={filterName}\n                            filters={filters}\n                            index={key}\n                            key={key}\n                            metadatas={metadatas}\n                            name={name}\n                            toggleFilterPickerState={toggleFilterPickerState}\n                            isFilterPickerOpen={isFilterPickerOpen}\n                            setQuery={setQuery}\n                            value={value}\n                          />\n                        ))}\n                      </>\n                    )}\n                  </div>\n                </div>\n                <div className=\"col-2\">\n                  <CheckPermissions permissions={pluginPermissions.collectionTypesConfigurations}>\n                    <FieldPicker\n                      displayedHeaders={displayedHeaders}\n                      items={allAllowedHeaders}\n                      onChange={handleChangeListLabels}\n                      onClickReset={onResetListHeaders}\n                      slug={slug}\n                    />\n                  </CheckPermissions>\n                </div>\n              </div>\n              <div className=\"row\" style={{ paddingTop: '12px' }}>\n                <div className=\"col-12\">\n                  <CustomTable\n                    data={data}\n                    canCreate={canCreate}\n                    canDelete={canDelete}\n                    canUpdate={canUpdate}\n                    displayedHeaders={displayedHeaders}\n                    hasDraftAndPublish={hasDraftAndPublish}\n                    isBulkable={isBulkable}\n                    setQuery={setQuery}\n                    showLoader={isLoading}\n                  />\n                  <Footer count={total} params={query} onChange={setQuery} />\n                </div>\n              </div>\n            </Wrapper>\n          )}\n        </Container>\n        <PopUpWarning\n          isOpen={showWarningDelete}\n          toggleModal={toggleModalDelete}\n          content={{\n            message: getTrad('popUpWarning.bodyMessage.contentType.delete'),\n          }}\n          onConfirm={handleConfirmDeleteData}\n          popUpWarningType=\"danger\"\n          onClosed={handleModalClose}\n          isConfirmButtonLoading={showModalConfirmButtonLoading}\n        />\n        <PopUpWarning\n          isOpen={showWarningDeleteAll}\n          toggleModal={toggleModalDeleteAll}\n          content={{\n            message: getTrad(\n              `popUpWarning.bodyMessage.contentType.delete${\n                entriesToDelete.length > 1 ? '.all' : ''\n              }`\n            ),\n          }}\n          popUpWarningType=\"danger\"\n          onConfirm={handleConfirmDeleteAllData}\n          onClosed={handleModalClose}\n          isConfirmButtonLoading={showModalConfirmButtonLoading}\n        />\n      </ListViewProvider>\n    </>\n  );\n}\n\nListView.propTypes = {\n  displayedHeaders: PropTypes.array.isRequired,\n  data: PropTypes.array.isRequired,\n  didDeleteData: PropTypes.bool.isRequired,\n  entriesToDelete: PropTypes.array.isRequired,\n  layout: PropTypes.exact({\n    components: PropTypes.object.isRequired,\n    contentType: PropTypes.shape({\n      attributes: PropTypes.object.isRequired,\n      metadatas: PropTypes.object.isRequired,\n      info: PropTypes.shape({ label: PropTypes.string.isRequired }).isRequired,\n      layouts: PropTypes.shape({\n        list: PropTypes.array.isRequired,\n        editRelations: PropTypes.array,\n      }).isRequired,\n      options: PropTypes.object.isRequired,\n      settings: PropTypes.object.isRequired,\n    }).isRequired,\n  }).isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  getData: PropTypes.func.isRequired,\n  getDataSucceeded: PropTypes.func.isRequired,\n  onChangeBulk: PropTypes.func.isRequired,\n  onChangeBulkSelectall: PropTypes.func.isRequired,\n  onChangeListHeaders: PropTypes.func.isRequired,\n  onDeleteDataError: PropTypes.func.isRequired,\n  onDeleteDataSucceeded: PropTypes.func.isRequired,\n  onDeleteSeveralDataSucceeded: PropTypes.func.isRequired,\n  onResetListHeaders: PropTypes.func.isRequired,\n  pagination: PropTypes.shape({ total: PropTypes.number.isRequired }).isRequired,\n  resetProps: PropTypes.func.isRequired,\n  setModalLoadingState: PropTypes.func.isRequired,\n  showModalConfirmButtonLoading: PropTypes.bool.isRequired,\n  showWarningDelete: PropTypes.bool.isRequired,\n  showWarningDeleteAll: PropTypes.bool.isRequired,\n  slug: PropTypes.string.isRequired,\n  toggleModalDelete: PropTypes.func.isRequired,\n  toggleModalDeleteAll: PropTypes.func.isRequired,\n  setLayout: PropTypes.func.isRequired,\n};\n\nconst mapStateToProps = makeSelectListView();\n\nexport function mapDispatchToProps(dispatch) {\n  return bindActionCreators(\n    {\n      getData,\n      getDataSucceeded,\n      onChangeBulk,\n      onChangeBulkSelectall,\n      onChangeListHeaders,\n      onDeleteDataError,\n      onDeleteDataSucceeded,\n      onDeleteSeveralDataSucceeded,\n      onResetListHeaders,\n      resetProps,\n      setModalLoadingState,\n      toggleModalDelete,\n      toggleModalDeleteAll,\n      setLayout,\n    },\n    dispatch\n  );\n}\nconst withConnect = connect(mapStateToProps, mapDispatchToProps);\n\nexport default compose(withConnect)(memo(ListView, isEqual));\n"]},"metadata":{},"sourceType":"script"}