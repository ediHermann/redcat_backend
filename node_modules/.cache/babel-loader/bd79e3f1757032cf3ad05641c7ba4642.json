{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _reactDnd = require(\"react-dnd\");\n\nvar _reactSelect = _interopRequireWildcard(require(\"react-select\"));\n\nvar _ItemTypes = _interopRequireDefault(require(\"../../utils/ItemTypes\"));\n\nvar _components = require(\"./components\");\n\nvar _ListItem = _interopRequireDefault(require(\"./ListItem\"));\n\nfunction SelectMany(_ref) {\n  var addRelation = _ref.addRelation,\n      components = _ref.components,\n      displayNavigationLink = _ref.displayNavigationLink,\n      mainField = _ref.mainField,\n      name = _ref.name,\n      isDisabled = _ref.isDisabled,\n      isLoading = _ref.isLoading,\n      move = _ref.move,\n      onInputChange = _ref.onInputChange,\n      onMenuClose = _ref.onMenuClose,\n      onMenuOpen = _ref.onMenuOpen,\n      onMenuScrollToBottom = _ref.onMenuScrollToBottom,\n      _onRemove = _ref.onRemove,\n      options = _ref.options,\n      placeholder = _ref.placeholder,\n      styles = _ref.styles,\n      targetModel = _ref.targetModel,\n      value = _ref.value;\n\n  var _useDrop = (0, _reactDnd.useDrop)({\n    accept: _ItemTypes[\"default\"].RELATION\n  }),\n      _useDrop2 = (0, _slicedToArray2[\"default\"])(_useDrop, 2),\n      drop = _useDrop2[1];\n\n  var findRelation = function findRelation(id) {\n    var relation = value.filter(function (c) {\n      return \"\".concat(c.id) === \"\".concat(id);\n    })[0];\n    return {\n      relation: relation,\n      index: value.indexOf(relation)\n    };\n  };\n\n  var moveRelation = (0, _react.useCallback)(function (id, atIndex) {\n    var _findRelation = findRelation(id),\n        index = _findRelation.index;\n\n    move(index, atIndex, name);\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [value]);\n  var filterConfig = {\n    ignoreCase: true,\n    ignoreAccents: true,\n    trim: false,\n    matchFrom: 'any'\n  };\n  return /*#__PURE__*/_react[\"default\"].createElement(_react[\"default\"].Fragment, null, /*#__PURE__*/_react[\"default\"].createElement(_reactSelect[\"default\"], {\n    components: components,\n    isDisabled: isDisabled,\n    id: name,\n    filterOption: function filterOption(candidate, input) {\n      if (!(0, _lodash.isEmpty)(value)) {\n        var isSelected = value.findIndex(function (item) {\n          return item.id === candidate.value.id;\n        }) !== -1;\n\n        if (isSelected) {\n          return false;\n        }\n      }\n\n      if (input) {\n        return (0, _reactSelect.createFilter)(filterConfig)(candidate, input);\n      }\n\n      return true;\n    },\n    mainField: mainField,\n    isLoading: isLoading,\n    isMulti: true,\n    isSearchable: true,\n    options: options,\n    onChange: addRelation,\n    onInputChange: onInputChange,\n    onMenuClose: onMenuClose,\n    onMenuOpen: onMenuOpen,\n    onMenuScrollToBottom: onMenuScrollToBottom,\n    placeholder: placeholder,\n    styles: styles,\n    value: []\n  }), /*#__PURE__*/_react[\"default\"].createElement(_components.ListWrapper, {\n    ref: drop\n  }, !(0, _lodash.isEmpty)(value) && /*#__PURE__*/_react[\"default\"].createElement(\"ul\", null, value.map(function (data, index) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_ListItem[\"default\"], {\n      key: data.id,\n      data: data,\n      displayNavigationLink: displayNavigationLink,\n      isDisabled: isDisabled,\n      findRelation: findRelation,\n      mainField: mainField,\n      moveRelation: moveRelation,\n      onRemove: function onRemove() {\n        if (!isDisabled) {\n          _onRemove(\"\".concat(name, \".\").concat(index));\n        }\n      },\n      targetModel: targetModel\n    });\n  })), !(0, _lodash.isEmpty)(value) && value.length > 4 && /*#__PURE__*/_react[\"default\"].createElement(_components.ListShadow, null)));\n}\n\nSelectMany.defaultProps = {\n  components: {},\n  move: function move() {},\n  value: null\n};\nSelectMany.propTypes = {\n  addRelation: _propTypes[\"default\"].func.isRequired,\n  components: _propTypes[\"default\"].object,\n  displayNavigationLink: _propTypes[\"default\"].bool.isRequired,\n  isDisabled: _propTypes[\"default\"].bool.isRequired,\n  isLoading: _propTypes[\"default\"].bool.isRequired,\n  mainField: _propTypes[\"default\"].shape({\n    name: _propTypes[\"default\"].string.isRequired,\n    schema: _propTypes[\"default\"].shape({\n      type: _propTypes[\"default\"].string.isRequired\n    }).isRequired\n  }).isRequired,\n  move: _propTypes[\"default\"].func,\n  name: _propTypes[\"default\"].string.isRequired,\n  onInputChange: _propTypes[\"default\"].func.isRequired,\n  onMenuClose: _propTypes[\"default\"].func.isRequired,\n  onMenuOpen: _propTypes[\"default\"].func.isRequired,\n  onMenuScrollToBottom: _propTypes[\"default\"].func.isRequired,\n  onRemove: _propTypes[\"default\"].func.isRequired,\n  options: _propTypes[\"default\"].array.isRequired,\n  placeholder: _propTypes[\"default\"].node.isRequired,\n  styles: _propTypes[\"default\"].object.isRequired,\n  targetModel: _propTypes[\"default\"].string.isRequired,\n  value: _propTypes[\"default\"].array\n};\n\nvar _default = /*#__PURE__*/(0, _react.memo)(SelectMany);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["D:/webstorm_projects/redcat_backend/.cache/plugins/strapi-plugin-content-manager/admin/src/components/SelectMany/index.js"],"names":["SelectMany","addRelation","components","displayNavigationLink","mainField","name","isDisabled","isLoading","move","onInputChange","onMenuClose","onMenuOpen","onMenuScrollToBottom","onRemove","options","placeholder","styles","targetModel","value","accept","ItemTypes","RELATION","drop","findRelation","id","relation","filter","c","index","indexOf","moveRelation","atIndex","filterConfig","ignoreCase","ignoreAccents","trim","matchFrom","candidate","input","isSelected","findIndex","item","map","data","length","defaultProps","propTypes","PropTypes","func","isRequired","object","bool","shape","string","schema","type","array","node"],"mappings":"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","sourcesContent":["import React, { memo, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { isEmpty } from 'lodash';\nimport { useDrop } from 'react-dnd';\nimport Select, { createFilter } from 'react-select';\nimport ItemTypes from '../../utils/ItemTypes';\nimport { ListShadow, ListWrapper } from './components';\nimport ListItem from './ListItem';\n\nfunction SelectMany({\n  addRelation,\n  components,\n  displayNavigationLink,\n  mainField,\n  name,\n  isDisabled,\n  isLoading,\n  move,\n  onInputChange,\n  onMenuClose,\n  onMenuOpen,\n  onMenuScrollToBottom,\n  onRemove,\n  options,\n  placeholder,\n  styles,\n  targetModel,\n  value,\n}) {\n  const [, drop] = useDrop({ accept: ItemTypes.RELATION });\n  const findRelation = id => {\n    const relation = value.filter(c => {\n      return `${c.id}` === `${id}`;\n    })[0];\n\n    return {\n      relation,\n      index: value.indexOf(relation),\n    };\n  };\n\n  const moveRelation = useCallback(\n    (id, atIndex) => {\n      const { index } = findRelation(id);\n\n      move(index, atIndex, name);\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [value]\n  );\n\n  const filterConfig = {\n    ignoreCase: true,\n    ignoreAccents: true,\n    trim: false,\n    matchFrom: 'any',\n  };\n\n  return (\n    <>\n      <Select\n        components={components}\n        isDisabled={isDisabled}\n        id={name}\n        filterOption={(candidate, input) => {\n          if (!isEmpty(value)) {\n            const isSelected = value.findIndex(item => item.id === candidate.value.id) !== -1;\n\n            if (isSelected) {\n              return false;\n            }\n          }\n\n          if (input) {\n            return createFilter(filterConfig)(candidate, input);\n          }\n\n          return true;\n        }}\n        mainField={mainField}\n        isLoading={isLoading}\n        isMulti\n        isSearchable\n        options={options}\n        onChange={addRelation}\n        onInputChange={onInputChange}\n        onMenuClose={onMenuClose}\n        onMenuOpen={onMenuOpen}\n        onMenuScrollToBottom={onMenuScrollToBottom}\n        placeholder={placeholder}\n        styles={styles}\n        value={[]}\n      />\n\n      <ListWrapper ref={drop}>\n        {!isEmpty(value) && (\n          <ul>\n            {value.map((data, index) => (\n              <ListItem\n                key={data.id}\n                data={data}\n                displayNavigationLink={displayNavigationLink}\n                isDisabled={isDisabled}\n                findRelation={findRelation}\n                mainField={mainField}\n                moveRelation={moveRelation}\n                onRemove={() => {\n                  if (!isDisabled) {\n                    onRemove(`${name}.${index}`);\n                  }\n                }}\n                targetModel={targetModel}\n              />\n            ))}\n          </ul>\n        )}\n        {!isEmpty(value) && value.length > 4 && <ListShadow />}\n      </ListWrapper>\n    </>\n  );\n}\n\nSelectMany.defaultProps = {\n  components: {},\n  move: () => {},\n  value: null,\n};\n\nSelectMany.propTypes = {\n  addRelation: PropTypes.func.isRequired,\n  components: PropTypes.object,\n  displayNavigationLink: PropTypes.bool.isRequired,\n  isDisabled: PropTypes.bool.isRequired,\n  isLoading: PropTypes.bool.isRequired,\n  mainField: PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    schema: PropTypes.shape({\n      type: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n  move: PropTypes.func,\n  name: PropTypes.string.isRequired,\n  onInputChange: PropTypes.func.isRequired,\n  onMenuClose: PropTypes.func.isRequired,\n  onMenuOpen: PropTypes.func.isRequired,\n  onMenuScrollToBottom: PropTypes.func.isRequired,\n  onRemove: PropTypes.func.isRequired,\n  options: PropTypes.array.isRequired,\n  placeholder: PropTypes.node.isRequired,\n  styles: PropTypes.object.isRequired,\n  targetModel: PropTypes.string.isRequired,\n  value: PropTypes.array,\n};\n\nexport default memo(SelectMany);\n"]},"metadata":{},"sourceType":"script"}