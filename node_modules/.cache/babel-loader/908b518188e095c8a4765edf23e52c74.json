{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DynamicZone = exports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _lodash = require(\"lodash\");\n\nvar _reactFastCompare = _interopRequireDefault(require(\"react-fast-compare\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactIntl = require(\"react-intl\");\n\nvar _strapiHelperPlugin = require(\"strapi-helper-plugin\");\n\nvar _pluginId = _interopRequireDefault(require(\"../../pluginId\"));\n\nvar _connect = _interopRequireDefault(require(\"./utils/connect\"));\n\nvar _select = _interopRequireDefault(require(\"./utils/select\"));\n\nvar _BaselineAlignement = _interopRequireDefault(require(\"./BaselineAlignement\"));\n\nvar _Button = _interopRequireDefault(require(\"./Button\"));\n\nvar _Component = _interopRequireDefault(require(\"./Component\"));\n\nvar _ComponentWrapper = _interopRequireDefault(require(\"./ComponentWrapper\"));\n\nvar _DynamicZoneWrapper = _interopRequireDefault(require(\"./DynamicZoneWrapper\"));\n\nvar _Label = _interopRequireDefault(require(\"./Label\"));\n\nvar _Wrapper = _interopRequireDefault(require(\"./Wrapper\"));\n\nvar _Picker = _interopRequireDefault(require(\"./Picker\"));\n\n/* eslint-disable react/no-array-index-key */\nvar DynamicZone = function DynamicZone(_ref) {\n  var name = _ref.name,\n      addComponentToDynamicZone = _ref.addComponentToDynamicZone,\n      formErrors = _ref.formErrors,\n      isCreatingEntry = _ref.isCreatingEntry,\n      isFieldAllowed = _ref.isFieldAllowed,\n      isFieldReadable = _ref.isFieldReadable,\n      moveComponentUp = _ref.moveComponentUp,\n      moveComponentDown = _ref.moveComponentDown,\n      removeComponentFromDynamicZone = _ref.removeComponentFromDynamicZone,\n      dynamicDisplayedComponents = _ref.dynamicDisplayedComponents,\n      fieldSchema = _ref.fieldSchema,\n      metadatas = _ref.metadatas;\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2[\"default\"])(_useState, 2),\n      isOpen = _useState2[0],\n      setIsOpen = _useState2[1]; // We cannot use the default props here\n\n\n  var _fieldSchema$max = fieldSchema.max,\n      max = _fieldSchema$max === void 0 ? Infinity : _fieldSchema$max,\n      _fieldSchema$min = fieldSchema.min,\n      min = _fieldSchema$min === void 0 ? -Infinity : _fieldSchema$min;\n  var dynamicZoneErrors = (0, _react.useMemo)(function () {\n    return Object.keys(formErrors).filter(function (key) {\n      return key === name;\n    }).map(function (key) {\n      return formErrors[key];\n    });\n  }, [formErrors, name]);\n  var dynamicZoneAvailableComponents = (0, _react.useMemo)(function () {\n    return fieldSchema.components || [];\n  }, [fieldSchema]);\n  var dynamicDisplayedComponentsLength = dynamicDisplayedComponents.length;\n  var missingComponentNumber = min - dynamicDisplayedComponentsLength;\n  var hasError = dynamicZoneErrors.length > 0;\n  var hasMinError = dynamicZoneErrors.length > 0 && (0, _lodash.get)(dynamicZoneErrors, [0, 'id'], '').includes('min');\n  var hasRequiredError = hasError && !hasMinError;\n  var hasMaxError = hasError && (0, _lodash.get)(dynamicZoneErrors, [0, 'id'], '') === 'components.Input.error.validation.max';\n  var handleAddComponent = (0, _react.useCallback)(function (componentUid) {\n    setIsOpen(false);\n    addComponentToDynamicZone(name, componentUid, hasError);\n  }, [addComponentToDynamicZone, hasError, name]);\n\n  var handleClickOpenPicker = function handleClickOpenPicker() {\n    if (dynamicDisplayedComponentsLength < max) {\n      setIsOpen(function (prev) {\n        return !prev;\n      });\n    } else {\n      strapi.notification.info(\"\".concat(_pluginId[\"default\"], \".components.notification.info.maximum-requirement\"));\n    }\n  };\n\n  if (!isFieldAllowed && isCreatingEntry) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_BaselineAlignement[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.NotAllowedInput, {\n      label: metadatas.label,\n      spacerHeight: \"5px\"\n    }));\n  }\n\n  if (!isFieldAllowed && !isFieldReadable && !isCreatingEntry) {\n    return /*#__PURE__*/_react[\"default\"].createElement(_BaselineAlignement[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(_strapiHelperPlugin.NotAllowedInput, {\n      label: metadatas.label,\n      spacerHeight: \"5px\"\n    }));\n  }\n\n  return /*#__PURE__*/_react[\"default\"].createElement(_DynamicZoneWrapper[\"default\"], null, dynamicDisplayedComponentsLength > 0 && /*#__PURE__*/_react[\"default\"].createElement(_Label[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(\"p\", null, metadatas.label), /*#__PURE__*/_react[\"default\"].createElement(\"p\", null, metadatas.description)), /*#__PURE__*/_react[\"default\"].createElement(_ComponentWrapper[\"default\"], null, dynamicDisplayedComponents.map(function (componentUid, index) {\n    var showDownIcon = isFieldAllowed && dynamicDisplayedComponentsLength > 0 && index < dynamicDisplayedComponentsLength - 1;\n    var showUpIcon = isFieldAllowed && dynamicDisplayedComponentsLength > 0 && index > 0;\n    return /*#__PURE__*/_react[\"default\"].createElement(_Component[\"default\"], {\n      componentUid: componentUid,\n      key: index,\n      index: index,\n      isFieldAllowed: isFieldAllowed,\n      moveComponentDown: moveComponentDown,\n      moveComponentUp: moveComponentUp,\n      name: name,\n      removeComponentFromDynamicZone: removeComponentFromDynamicZone,\n      showDownIcon: showDownIcon,\n      showUpIcon: showUpIcon\n    });\n  })), isFieldAllowed ? /*#__PURE__*/_react[\"default\"].createElement(_Wrapper[\"default\"], null, /*#__PURE__*/_react[\"default\"].createElement(_Button[\"default\"], {\n    type: \"button\",\n    hasError: hasError,\n    className: isOpen && 'isOpen',\n    onClick: handleClickOpenPicker\n  }), hasRequiredError && !isOpen && !hasMaxError && /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"error-label\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"\".concat(_pluginId[\"default\"], \".components.DynamicZone.required\")\n  })), hasMaxError && !isOpen && /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"error-label\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"components.Input.error.validation.max\"\n  })), hasMinError && !isOpen && /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"error-label\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"\".concat(_pluginId[\"default\"], \".components.DynamicZone.missing\").concat(missingComponentNumber > 1 ? '.plural' : '.singular'),\n    values: {\n      count: missingComponentNumber\n    }\n  })), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n    className: \"info\"\n  }, /*#__PURE__*/_react[\"default\"].createElement(_reactIntl.FormattedMessage, {\n    id: \"\".concat(_pluginId[\"default\"], \".components.DynamicZone.add-compo\"),\n    values: {\n      componentName: metadatas.label\n    }\n  })), /*#__PURE__*/_react[\"default\"].createElement(_Picker[\"default\"], {\n    isOpen: isOpen,\n    components: dynamicZoneAvailableComponents,\n    onClickAddComponent: handleAddComponent\n  })) : /*#__PURE__*/_react[\"default\"].createElement(_BaselineAlignement[\"default\"], {\n    top: \"9px\"\n  }));\n};\n\nexports.DynamicZone = DynamicZone;\nDynamicZone.defaultProps = {\n  dynamicDisplayedComponents: [],\n  fieldSchema: {\n    max: Infinity,\n    min: -Infinity\n  }\n};\nDynamicZone.propTypes = {\n  addComponentToDynamicZone: _propTypes[\"default\"].func.isRequired,\n  dynamicDisplayedComponents: _propTypes[\"default\"].array,\n  fieldSchema: _propTypes[\"default\"].shape({\n    components: _propTypes[\"default\"].array.isRequired,\n    max: _propTypes[\"default\"].number,\n    min: _propTypes[\"default\"].number\n  }),\n  formErrors: _propTypes[\"default\"].object.isRequired,\n  isCreatingEntry: _propTypes[\"default\"].bool.isRequired,\n  isFieldAllowed: _propTypes[\"default\"].bool.isRequired,\n  isFieldReadable: _propTypes[\"default\"].bool.isRequired,\n  metadatas: _propTypes[\"default\"].shape({\n    description: _propTypes[\"default\"].string,\n    label: _propTypes[\"default\"].string\n  }).isRequired,\n  moveComponentUp: _propTypes[\"default\"].func.isRequired,\n  moveComponentDown: _propTypes[\"default\"].func.isRequired,\n  name: _propTypes[\"default\"].string.isRequired,\n  removeComponentFromDynamicZone: _propTypes[\"default\"].func.isRequired\n};\nvar Memoized = /*#__PURE__*/(0, _react.memo)(DynamicZone, _reactFastCompare[\"default\"]);\n\nvar _default = (0, _connect[\"default\"])(Memoized, _select[\"default\"]);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["D:/webstorm_projects/redcat_backend/.cache/plugins/strapi-plugin-content-manager/admin/src/components/DynamicZone/index.js"],"names":["DynamicZone","name","addComponentToDynamicZone","formErrors","isCreatingEntry","isFieldAllowed","isFieldReadable","moveComponentUp","moveComponentDown","removeComponentFromDynamicZone","dynamicDisplayedComponents","fieldSchema","metadatas","isOpen","setIsOpen","max","Infinity","min","dynamicZoneErrors","Object","keys","filter","key","map","dynamicZoneAvailableComponents","components","dynamicDisplayedComponentsLength","length","missingComponentNumber","hasError","hasMinError","includes","hasRequiredError","hasMaxError","handleAddComponent","componentUid","handleClickOpenPicker","prev","strapi","notification","info","pluginId","label","description","index","showDownIcon","showUpIcon","count","componentName","defaultProps","propTypes","PropTypes","func","isRequired","array","shape","number","object","bool","string","Memoized","isEqual","select"],"mappings":"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","sourcesContent":["import React, { memo, useCallback, useMemo, useState } from 'react';\nimport { get } from 'lodash';\nimport isEqual from 'react-fast-compare';\nimport PropTypes from 'prop-types';\nimport { FormattedMessage } from 'react-intl';\nimport { NotAllowedInput } from 'strapi-helper-plugin';\nimport pluginId from '../../pluginId';\nimport connect from './utils/connect';\nimport select from './utils/select';\nimport BaselineAlignement from './BaselineAlignement';\nimport Button from './Button';\nimport Component from './Component';\nimport ComponentWrapper from './ComponentWrapper';\nimport DynamicZoneWrapper from './DynamicZoneWrapper';\nimport Label from './Label';\nimport Wrapper from './Wrapper';\nimport Picker from './Picker';\n\n/* eslint-disable react/no-array-index-key */\n\nconst DynamicZone = ({\n  name,\n  // Passed with the select function\n  addComponentToDynamicZone,\n  formErrors,\n  isCreatingEntry,\n  isFieldAllowed,\n  isFieldReadable,\n  moveComponentUp,\n  moveComponentDown,\n  removeComponentFromDynamicZone,\n  dynamicDisplayedComponents,\n  fieldSchema,\n  metadatas,\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  // We cannot use the default props here\n  const { max = Infinity, min = -Infinity } = fieldSchema;\n  const dynamicZoneErrors = useMemo(() => {\n    return Object.keys(formErrors)\n      .filter(key => {\n        return key === name;\n      })\n      .map(key => formErrors[key]);\n  }, [formErrors, name]);\n\n  const dynamicZoneAvailableComponents = useMemo(() => fieldSchema.components || [], [fieldSchema]);\n  const dynamicDisplayedComponentsLength = dynamicDisplayedComponents.length;\n  const missingComponentNumber = min - dynamicDisplayedComponentsLength;\n  const hasError = dynamicZoneErrors.length > 0;\n  const hasMinError =\n    dynamicZoneErrors.length > 0 && get(dynamicZoneErrors, [0, 'id'], '').includes('min');\n\n  const hasRequiredError = hasError && !hasMinError;\n  const hasMaxError =\n    hasError && get(dynamicZoneErrors, [0, 'id'], '') === 'components.Input.error.validation.max';\n\n  const handleAddComponent = useCallback(\n    componentUid => {\n      setIsOpen(false);\n\n      addComponentToDynamicZone(name, componentUid, hasError);\n    },\n    [addComponentToDynamicZone, hasError, name]\n  );\n\n  const handleClickOpenPicker = () => {\n    if (dynamicDisplayedComponentsLength < max) {\n      setIsOpen(prev => !prev);\n    } else {\n      strapi.notification.info(`${pluginId}.components.notification.info.maximum-requirement`);\n    }\n  };\n\n  if (!isFieldAllowed && isCreatingEntry) {\n    return (\n      <BaselineAlignement>\n        <NotAllowedInput label={metadatas.label} spacerHeight=\"5px\" />\n      </BaselineAlignement>\n    );\n  }\n\n  if (!isFieldAllowed && !isFieldReadable && !isCreatingEntry) {\n    return (\n      <BaselineAlignement>\n        <NotAllowedInput label={metadatas.label} spacerHeight=\"5px\" />\n      </BaselineAlignement>\n    );\n  }\n\n  return (\n    <DynamicZoneWrapper>\n      {dynamicDisplayedComponentsLength > 0 && (\n        <Label>\n          <p>{metadatas.label}</p>\n          <p>{metadatas.description}</p>\n        </Label>\n      )}\n\n      {/* List of displayed components */}\n      <ComponentWrapper>\n        {dynamicDisplayedComponents.map((componentUid, index) => {\n          const showDownIcon =\n            isFieldAllowed &&\n            dynamicDisplayedComponentsLength > 0 &&\n            index < dynamicDisplayedComponentsLength - 1;\n          const showUpIcon = isFieldAllowed && dynamicDisplayedComponentsLength > 0 && index > 0;\n\n          return (\n            <Component\n              componentUid={componentUid}\n              key={index}\n              index={index}\n              isFieldAllowed={isFieldAllowed}\n              moveComponentDown={moveComponentDown}\n              moveComponentUp={moveComponentUp}\n              name={name}\n              removeComponentFromDynamicZone={removeComponentFromDynamicZone}\n              showDownIcon={showDownIcon}\n              showUpIcon={showUpIcon}\n            />\n          );\n        })}\n      </ComponentWrapper>\n      {isFieldAllowed ? (\n        <Wrapper>\n          <Button\n            type=\"button\"\n            hasError={hasError}\n            className={isOpen && 'isOpen'}\n            onClick={handleClickOpenPicker}\n          />\n          {hasRequiredError && !isOpen && !hasMaxError && (\n            <div className=\"error-label\">\n              <FormattedMessage id={`${pluginId}.components.DynamicZone.required`} />\n            </div>\n          )}\n          {hasMaxError && !isOpen && (\n            <div className=\"error-label\">\n              <FormattedMessage id=\"components.Input.error.validation.max\" />\n            </div>\n          )}\n          {hasMinError && !isOpen && (\n            <div className=\"error-label\">\n              <FormattedMessage\n                id={`${pluginId}.components.DynamicZone.missing${\n                  missingComponentNumber > 1 ? '.plural' : '.singular'\n                }`}\n                values={{ count: missingComponentNumber }}\n              />\n            </div>\n          )}\n          <div className=\"info\">\n            <FormattedMessage\n              id={`${pluginId}.components.DynamicZone.add-compo`}\n              values={{ componentName: metadatas.label }}\n            />\n          </div>\n          <Picker\n            isOpen={isOpen}\n            components={dynamicZoneAvailableComponents}\n            onClickAddComponent={handleAddComponent}\n          />\n        </Wrapper>\n      ) : (\n        <BaselineAlignement top=\"9px\" />\n      )}\n    </DynamicZoneWrapper>\n  );\n};\n\nDynamicZone.defaultProps = {\n  dynamicDisplayedComponents: [],\n  fieldSchema: {\n    max: Infinity,\n    min: -Infinity,\n  },\n};\n\nDynamicZone.propTypes = {\n  addComponentToDynamicZone: PropTypes.func.isRequired,\n  dynamicDisplayedComponents: PropTypes.array,\n  fieldSchema: PropTypes.shape({\n    components: PropTypes.array.isRequired,\n    max: PropTypes.number,\n    min: PropTypes.number,\n  }),\n  formErrors: PropTypes.object.isRequired,\n  isCreatingEntry: PropTypes.bool.isRequired,\n  isFieldAllowed: PropTypes.bool.isRequired,\n  isFieldReadable: PropTypes.bool.isRequired,\n  metadatas: PropTypes.shape({\n    description: PropTypes.string,\n    label: PropTypes.string,\n  }).isRequired,\n  moveComponentUp: PropTypes.func.isRequired,\n  moveComponentDown: PropTypes.func.isRequired,\n  name: PropTypes.string.isRequired,\n  removeComponentFromDynamicZone: PropTypes.func.isRequired,\n};\n\nconst Memoized = memo(DynamicZone, isEqual);\n\nexport default connect(Memoized, select);\n\nexport { DynamicZone };\n"]},"metadata":{},"sourceType":"script"}