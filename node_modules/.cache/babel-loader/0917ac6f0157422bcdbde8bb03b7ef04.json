{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _reactDnd = require(\"react-dnd\");\n\nvar _reactDndHtml5Backend = require(\"react-dnd-html5-backend\");\n\nvar _lodash = require(\"lodash\");\n\nvar _pluginId = _interopRequireDefault(require(\"../../pluginId\"));\n\nvar _ItemTypes = _interopRequireDefault(require(\"../../utils/ItemTypes\"));\n\nvar _components = require(\"./components\");\n\nvar _Relation = _interopRequireDefault(require(\"./Relation\"));\n\nfunction ListItem(_ref) {\n  var data = _ref.data,\n      displayNavigationLink = _ref.displayNavigationLink,\n      findRelation = _ref.findRelation,\n      isDisabled = _ref.isDisabled,\n      mainField = _ref.mainField,\n      moveRelation = _ref.moveRelation,\n      onRemove = _ref.onRemove,\n      targetModel = _ref.targetModel;\n  var to = \"/plugins/\".concat(_pluginId[\"default\"], \"/collectionType/\").concat(targetModel, \"/\").concat(data.id);\n  var hasDraftAndPublish = (0, _lodash.has)(data, 'published_at');\n  var originalIndex = findRelation(data.id).index;\n\n  var _useDrag = (0, _reactDnd.useDrag)({\n    item: {\n      type: _ItemTypes[\"default\"].RELATION,\n      id: data.id,\n      originalIndex: originalIndex,\n      data: data,\n      hasDraftAndPublish: hasDraftAndPublish,\n      mainField: mainField\n    },\n    collect: function collect(monitor) {\n      return {\n        isDragging: monitor.isDragging()\n      };\n    }\n  }),\n      _useDrag2 = (0, _slicedToArray2[\"default\"])(_useDrag, 3),\n      isDragging = _useDrag2[0].isDragging,\n      drag = _useDrag2[1],\n      preview = _useDrag2[2];\n\n  var _useDrop = (0, _reactDnd.useDrop)({\n    accept: _ItemTypes[\"default\"].RELATION,\n    canDrop: function canDrop() {\n      return false;\n    },\n    hover: function hover(_ref2) {\n      var draggedId = _ref2.id;\n\n      if (draggedId !== data.id) {\n        var _findRelation = findRelation(data.id),\n            overIndex = _findRelation.index;\n\n        moveRelation(draggedId, overIndex);\n      }\n    }\n  }),\n      _useDrop2 = (0, _slicedToArray2[\"default\"])(_useDrop, 2),\n      drop = _useDrop2[1];\n\n  (0, _react.useEffect)(function () {\n    preview((0, _reactDndHtml5Backend.getEmptyImage)(), {\n      captureDraggingState: true\n    });\n  }, [preview]);\n  var opacity = isDragging ? 0.2 : 1;\n  return /*#__PURE__*/_react[\"default\"].createElement(_components.Li, {\n    ref: function ref(node) {\n      if (!isDisabled) {\n        drag(drop(node));\n      }\n    },\n    style: {\n      opacity: opacity\n    }\n  }, /*#__PURE__*/_react[\"default\"].createElement(_Relation[\"default\"], {\n    displayNavigationLink: displayNavigationLink,\n    hasDraftAndPublish: hasDraftAndPublish,\n    mainField: mainField,\n    onRemove: onRemove,\n    data: data,\n    to: to,\n    isDisabled: isDisabled\n  }));\n}\n\nListItem.defaultProps = {\n  findRelation: function findRelation() {},\n  moveRelation: function moveRelation() {},\n  onRemove: function onRemove() {},\n  targetModel: ''\n};\nListItem.propTypes = {\n  data: _propTypes[\"default\"].object.isRequired,\n  displayNavigationLink: _propTypes[\"default\"].bool.isRequired,\n  findRelation: _propTypes[\"default\"].func,\n  isDisabled: _propTypes[\"default\"].bool.isRequired,\n  mainField: _propTypes[\"default\"].shape({\n    name: _propTypes[\"default\"].string.isRequired,\n    schema: _propTypes[\"default\"].shape({\n      type: _propTypes[\"default\"].string.isRequired\n    }).isRequired\n  }).isRequired,\n  moveRelation: _propTypes[\"default\"].func,\n  onRemove: _propTypes[\"default\"].func,\n  targetModel: _propTypes[\"default\"].string\n};\n\nvar _default = /*#__PURE__*/(0, _react.memo)(ListItem);\n\nexports[\"default\"] = _default;","map":{"version":3,"sources":["D:/webstorm_projects/redcat_backend/.cache/plugins/strapi-plugin-content-manager/admin/src/components/SelectMany/ListItem.js"],"names":["ListItem","data","displayNavigationLink","findRelation","isDisabled","mainField","moveRelation","onRemove","targetModel","to","pluginId","id","hasDraftAndPublish","originalIndex","index","item","type","ItemTypes","RELATION","collect","monitor","isDragging","drag","preview","accept","canDrop","hover","draggedId","overIndex","drop","captureDraggingState","opacity","node","defaultProps","propTypes","PropTypes","object","isRequired","bool","func","shape","name","string","schema"],"mappings":"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","sourcesContent":["import React, { memo, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport { useDrag, useDrop } from 'react-dnd';\nimport { getEmptyImage } from 'react-dnd-html5-backend';\nimport { has } from 'lodash';\n\nimport pluginId from '../../pluginId';\nimport ItemTypes from '../../utils/ItemTypes';\n\nimport { Li } from './components';\nimport Relation from './Relation';\n\nfunction ListItem({\n  data,\n  displayNavigationLink,\n  findRelation,\n  isDisabled,\n  mainField,\n  moveRelation,\n  onRemove,\n  targetModel,\n}) {\n  const to = `/plugins/${pluginId}/collectionType/${targetModel}/${data.id}`;\n\n  const hasDraftAndPublish = has(data, 'published_at');\n\n  const originalIndex = findRelation(data.id).index;\n  const [{ isDragging }, drag, preview] = useDrag({\n    item: {\n      type: ItemTypes.RELATION,\n      id: data.id,\n      originalIndex,\n      data,\n      hasDraftAndPublish,\n      mainField,\n    },\n    collect: monitor => ({\n      isDragging: monitor.isDragging(),\n    }),\n  });\n  const [, drop] = useDrop({\n    accept: ItemTypes.RELATION,\n    canDrop: () => false,\n    hover({ id: draggedId }) {\n      if (draggedId !== data.id) {\n        const { index: overIndex } = findRelation(data.id);\n        moveRelation(draggedId, overIndex);\n      }\n    },\n  });\n\n  useEffect(() => {\n    preview(getEmptyImage(), { captureDraggingState: true });\n  }, [preview]);\n\n  const opacity = isDragging ? 0.2 : 1;\n\n  return (\n    <Li\n      ref={node => {\n        if (!isDisabled) {\n          drag(drop(node));\n        }\n      }}\n      style={{ opacity }}\n    >\n      <Relation\n        displayNavigationLink={displayNavigationLink}\n        hasDraftAndPublish={hasDraftAndPublish}\n        mainField={mainField}\n        onRemove={onRemove}\n        data={data}\n        to={to}\n        isDisabled={isDisabled}\n      />\n    </Li>\n  );\n}\n\nListItem.defaultProps = {\n  findRelation: () => {},\n  moveRelation: () => {},\n  onRemove: () => {},\n  targetModel: '',\n};\n\nListItem.propTypes = {\n  data: PropTypes.object.isRequired,\n  displayNavigationLink: PropTypes.bool.isRequired,\n  findRelation: PropTypes.func,\n  isDisabled: PropTypes.bool.isRequired,\n  mainField: PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    schema: PropTypes.shape({\n      type: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n  moveRelation: PropTypes.func,\n  onRemove: PropTypes.func,\n  targetModel: PropTypes.string,\n};\n\nexport default memo(ListItem);\n"]},"metadata":{},"sourceType":"script"}